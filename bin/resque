#!/usr/bin/env ruby

require 'resque'

loop do
  if Resque.queue[:default].length == 0
    sleep 1
    next
  end

  klass, args = Resque.queue[:default].pop
  result = klass.perform(*args)
  puts "PROCESSED JOB. RESULT: #{result}"
end
